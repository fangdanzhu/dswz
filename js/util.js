/**
 * Created by Administrator on 2017/4/5.
 * ?Щ????js???
 */

//?????
function setBanner() {

    //???С???
    var $circleLis = $(".circle-list li");

    //???????
    var $bannerLis = $(".banner-list li");

    //???????????＼?
    var thatIndex = 0;

    //????????????
    var timer = null;

    //??С???????????
    $circleLis.on("click", function() {

        //???????????е?С?????＼??????????????????＼??
        //?????????????????С???????????
        if($(this).index() != thatIndex) {

            //???????????＼??С?????＼?
            thatIndex = $(this).index();

            //??е???????С???
            $(this).addClass("current").siblings("li").removeClass("current");

            //????????
            $bannerLis.removeClass("active");

            //????С?????＼???ж????????
            var $banner = $bannerLis.eq(thatIndex);

            //????????
            $banner.addClass("active");
            $banner.css("opacity", "0");
            animate($banner[0], {opacity : 100}, 40);
        }
    });

    //?????????,???????????????
    timer = setInterval(autoPlayBanner, 3000);

    //?????????????????????????????
    $(".banner-list").mouseenter(function() {
        clearInterval(timer);
    });

    //??????????????????????????
    $(".banner-list").mouseleave(function() {
        timer = setInterval(autoPlayBanner, 3000);
    });

    //???????????
    function autoPlayBanner() {

        //?????????????????
        //???1????????
        thatIndex = ++thatIndex > $bannerLis.length - 1 ? 0 : thatIndex;

        //???С???
        $circleLis.removeClass("current");
        $circleLis.eq(thatIndex).addClass("current");

        //????????
        $bannerLis.removeClass("active");

        //????С?????＼???ж????????
        var $banner = $bannerLis.eq(thatIndex);

        //????????
        $banner.addClass("active");
        $banner.css("opacity", "0");
        animate($banner[0], {opacity : 100}, 40);
    }
}


/***
 * ??????????‖???
 * @param url ?????url
 * @param method ???????
 * @param dataType ?????????????
 * @param data ????????
 * @param callback ???????
 * @param jsonp ?????jsonp????????д?????????????,????????????? "callback=?"?е?callback
 * @param jsonpCallback ?jsonp???????????????????,?????????????jQuery?????????????????
 */
function getData(url, method, dataType, parem, callback) {
    $.ajax({
        url: url,
        type: method,
        dataType: dataType,
        data: parem,
        success:callback
    });
}


/***
 * ??????????
 * @param id ?????id
 * @param data ????????????????????
 * @param flag ???λ(1:???2:?У?3:??)
 * @param callback ???????
 */
function setAddress(id, data, flag, callback) {

    $("#" + id + " .select-options").children("li").remove();

    //????json????
    $.each(data, function(index, obj) {
        var $li = $("<li></li>").html(obj.name).attr("value", obj.code);
        $("#" + id + " .select-options").append($li);
    });

    var code = $("#" + id + " .select-options").children("li:eq(0)").attr("value");
    var name = $("#" + id + " .select-options").children("li:eq(0)")[0].innerHTML;
    $("#" + id + " .select-name").html(name);

    if(flag != null) {
        var parem = {"citycode": code, "flag": flag};
        getData(config.addressUrl, 'get', 'jsonp', parem, callback);
    }
}


/**
 * ?????????
 * @param id ?????id
 * @param flag ???λ(1:???2:?У?3:??)
 * @param callback ???????
 */
function changeAddress(id, flag, callback) {

    $("#" + id).mouseenter(function() {
        $("#" + id + " .select-options").show();
    });

    $("#" + id).mouseleave(function() {
        $("#" + id + "  .select-options").hide();
    });

    $("#" + id + " .select-options li").click(function() {
        $("#" + id + " .select-name").html($(this)[0].innerHTML);
        $("#" + id + " .select-options").hide();

        var code = $(this).attr("value");

        if(flag != null) {
            var code = $(this).attr("value");
            var parem = {"citycode": code, "flag": flag};
            getData(config.addressUrl, 'get', 'jsonp', parem, callback);
        }
    });
}


/***
 * ????????overflow-y????
 * @param id ?????id
 */
function setOverflowY(id) {

    var $dom = $("#" + id + " .select-options");
    var $li = $("#" + id + " .select-options li")
    var height = $dom.height();

    if(height < 122) {
        $dom.css("overflow-y", "inherit");
        $li.css("width", "100%");
    } else {
        $dom.css("overflow-y", "scroll");
        $li.css("width", "93px");
    }
}